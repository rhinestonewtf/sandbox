import { Hex } from "viem";
import { signMessage } from "@wagmi/core";
import { Account } from "../domains/Account";
import { Validator } from "../domains/Module/Module";
import { signUserOpHash } from "../domains/UserOperation/api/signUserOp";

export type ContractDependencies = {
  [name: string]: Hex;
};

export type ValidatorList = {
  [name: string]: Validator;
};

export const validators: ValidatorList = {
  ecdsa: {
    name: "ecdsa",
    address: "0x8bd8CabFA94DC1257EAd0F290753B145ACf10b28",
    mockSignature:
      "0xe8b94748580ca0b4993c9a1b86b5be851bfc076ff5ce3a1ff65bf16392acfcb800f9b4f1aef1555c7fce5599fffb17e7c635502154a0333ba21f3ae491839af51c",
    signMessageAsync: async (message: Hex, activeAccount: Account) => {
      return await signMessage({ message });
    },
  },
  webauthn: {
    name: "webauthn",
    address: "0xb432161048C2954e70864e275FFafe24E70270d7",
    mockSignature:
      "0x07855b46a623a8ecabac76ed697aa4e13631e3b6718c8a0d342860c13c30d2fc00000000000000000000000000000000000000000000000000000000000000e0010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000024456b4f30bac4a8994b010d127650e6f22669f7f7aec4475f80f8c2a8d2ed02872b0aca713e929d8a28596b42f325fa9587a16a8eb2bc07e4b3a3e9c14a7b988100000000000000000000000000000000000000000000000000000000000000251584482fdf7a4d0b7eb9d45cf835288cb59e55b8249fff356e33be88ecc546d11d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000957b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a22307831383138356261383531633032383032323035366564396634326261313434396532613138663739323932326238383939363937313962616665373861653563222c226f726967696e223a2268747470733a2f2f646576656c6f706d656e742e666f72756d64616f732e636f6d227d0000000000000000000000",
    signMessageAsync: async (message: Hex, activeAccount: Account) => {
      return await signUserOpHash(message, activeAccount);
    },
  },
};

export const contracts: ContractDependencies = {
  // CORE
  ENTRY_POINT_ADDRESS: "0x5FF137D4b0FDCD49DcA30c7CF57E578a026d2789",
  ACCOUNT_FACTORY_ADDRESS: "0x792e83EF80Fb74afd5d2019829b27cC4bC37DeF5",
  SINGLETON_ADDRESS: "0x5A0CBB08b38B8d546050269b06F82306D42E0128",
  REGISTRY_ADDRESS: "0xE6b4923Ca38A5310b96784e732a52BF4999ee6Ab",

  // MODULES
  ECDSA_VALIDATOR_ADDRESS: "0x8bd8CabFA94DC1257EAd0F290753B145ACf10b28", // ownable validator
  WEBAUTHN_VALIDATOR_ADDRESS: "0xb432161048C2954e70864e275FFafe24E70270d7",

  // UTILITIES
  BOOTSTRAP_ADDRESS: "0x0be6d7bc8dA4e6a9521fB74da80B2BED434C8d23",
};
